<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –º–∏–≥–∞–ª–æ–∫ —á–∏–ø-—Ç—é–Ω–∏–Ω–≥–∞</title>
    <style>
        body {
            background: #000;
            color: #fff;
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .pass { background: #00ff0030; border: 1px solid #00ff00; }
        .fail { background: #ff000030; border: 1px solid #ff0000; }
        button {
            background: #0099ff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0077cc; }
    </style>
</head>
<body>
    <h1>üîç –¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –º–∏–≥–∞–ª–æ–∫</h1>
    <div id="results"></div>
    <hr>
    <h2>–†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</h2>
    <button onclick="clearStorage()">–û—á–∏—Å—Ç–∏—Ç—å sessionStorage</button>
    <button onclick="checkStorage()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ</button>
    <button onclick="runTests()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã</button>

    <script>
        const results = document.getElementById('results');

        function addResult(name, passed, details) {
            const div = document.createElement('div');
            div.className = `test-result ${passed ? 'pass' : 'fail'}`;
            div.innerHTML = `
                <strong>${passed ? '‚úÖ' : '‚ùå'} ${name}</strong><br>
                <small>${details}</small>
            `;
            results.appendChild(div);
        }

        function clearStorage() {
            sessionStorage.removeItem('chiptuning-lights-shown');
            addResult('SessionStorage –æ—á–∏—â–µ–Ω', true, '–ö–ª—é—á chiptuning-lights-shown —É–¥–∞–ª—ë–Ω');
        }

        function checkStorage() {
            const value = sessionStorage.getItem('chiptuning-lights-shown');
            addResult('–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è', true, `chiptuning-lights-shown = ${value || 'null'}`);
        }

        function runTests() {
            results.innerHTML = '';

            // –¢–µ—Å—Ç 1: sessionStorage –¥–æ—Å—Ç—É–ø–µ–Ω
            try {
                sessionStorage.setItem('test', '1');
                sessionStorage.removeItem('test');
                addResult('SessionStorage –¥–æ—Å—Ç—É–ø–µ–Ω', true, 'API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ');
            } catch (e) {
                addResult('SessionStorage –¥–æ—Å—Ç—É–ø–µ–Ω', false, e.message);
            }

            // –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–∞
            const hasShown = sessionStorage.getItem('chiptuning-lights-shown');
            addResult(
                '–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–∞ –º–∏–≥–∞–ª–æ–∫',
                true,
                `–ó–Ω–∞—á–µ–Ω–∏–µ: ${hasShown || '–Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ (–º–∏–≥–∞–ª–∫–∏ –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã)'}`
            );

            // –¢–µ—Å—Ç 3: –°–∏–º—É–ª—è—Ü–∏—è –ª–æ–≥–∏–∫–∏
            if (!hasShown) {
                addResult('–õ–æ–≥–∏–∫–∞ –ø–æ–∫–∞–∑–∞', true, '–ú–∏–≥–∞–ª–∫–∏ –ë–£–î–£–¢ –ø–æ–∫–∞–∑–∞–Ω—ã (–∫–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω)');
            } else {
                addResult('–õ–æ–≥–∏–∫–∞ –ø–æ–∫–∞–∑–∞', true, '–ú–∏–≥–∞–ª–∫–∏ –ù–ï –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã (–∫–ª—é—á —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)');
            }

            // –¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏
            const startTime = Date.now();
            setTimeout(() => {
                const elapsed = Date.now() - startTime;
                const correct = elapsed >= 6500 && elapsed < 6600;
                addResult(
                    '–¢–∞–π–º–µ—Ä 6500ms',
                    correct,
                    `–ü—Ä–æ—à–ª–æ ${elapsed}ms (–æ–∂–∏–¥–∞–ª–æ—Å—å 6500ms)`
                );
            }, 6500);

            // –¢–µ—Å—Ç 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ CSS –∫–ª–∞—Å—Å–∞
            const testDiv = document.createElement('div');
            testDiv.className = 'chiptuning-dialog with-police-lights';
            document.body.appendChild(testDiv);
            const hasAnimation = window.getComputedStyle(testDiv).animation !== 'none';
            testDiv.remove();
            addResult(
                'CSS –∫–ª–∞—Å—Å .with-police-lights',
                true,
                `–ê–Ω–∏–º–∞—Ü–∏—è: ${hasAnimation ? '–ø—Ä–∏–º–µ–Ω–µ–Ω–∞' : '–Ω–µ –Ω–∞–π–¥–µ–Ω–∞ (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∞)'}`
            );

            addResult('–í—Å–µ —Ç–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã', true, '–ü—Ä–æ–≤–µ—Ä—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã—à–µ');
        }

        // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = runTests;
    </script>
</body>
</html>
